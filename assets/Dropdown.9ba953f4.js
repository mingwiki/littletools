import{r,u as U,y as Z,q as S,f as j,m as w,E as $,D as ee}from"./index.7f8fbf38.js";import{a as te}from"./index.98acfa39.js";import{K as D}from"./KeyCode.bb3c3291.js";var c={adjustX:1,adjustY:1},u=[0,0],ne={topLeft:{points:["bl","tl"],overflow:c,offset:[0,-4],targetOffset:u},topCenter:{points:["bc","tc"],overflow:c,offset:[0,-4],targetOffset:u},topRight:{points:["br","tr"],overflow:c,offset:[0,-4],targetOffset:u},bottomLeft:{points:["tl","bl"],overflow:c,offset:[0,4],targetOffset:u},bottomCenter:{points:["tc","bc"],overflow:c,offset:[0,4],targetOffset:u},bottomRight:{points:["tr","br"],overflow:c,offset:[0,4],targetOffset:u}},re=D.ESC,ae=D.TAB;function ie(e){var v=e.visible,C=e.setTriggerVisible,d=e.triggerRef,m=e.menuRef,i=e.onVisibleChange,p=r.exports.useRef(!1),h=function(){if(v&&d.current){var o,a,s,g;(o=d.current)===null||o===void 0||(a=o.triggerRef)===null||a===void 0||(s=a.current)===null||s===void 0||(g=s.focus)===null||g===void 0||g.call(s),C(!1),typeof i=="function"&&i(!1)}},y=function(o){var a;switch(o.keyCode){case re:h();break;case ae:!p.current&&((a=m.current)===null||a===void 0?void 0:a.focus)?(o.preventDefault(),m.current.focus(),p.current=!0):h();break}};r.exports.useEffect(function(){return v?(window.addEventListener("keydown",y),function(){window.removeEventListener("keydown",y),p.current=!1}):function(){return null}},[v])}var oe=["arrow","prefixCls","transitionName","animation","align","placement","placements","getPopupContainer","showAction","hideAction","overlayClassName","overlayStyle","visible","trigger"];function le(e,v){var C=e.arrow,d=C===void 0?!1:C,m=e.prefixCls,i=m===void 0?"rc-dropdown":m,p=e.transitionName,h=e.animation,y=e.align,b=e.placement,o=b===void 0?"bottomLeft":b,a=e.placements,s=a===void 0?ne:a,g=e.getPopupContainer,L=e.showAction,W=e.hideAction,K=e.overlayClassName,F=e.overlayStyle,B=e.visible,P=e.trigger,M=P===void 0?["hover"]:P,H=U(e,oe),q=r.exports.useState(),R=Z(q,2),I=R[0],x=R[1],O="visible"in e?B:I,E=r.exports.useRef(null);r.exports.useImperativeHandle(v,function(){return E.current});var V=r.exports.useRef(null),X="".concat(i,"-menu");ie({visible:O,setTriggerVisible:x,triggerRef:E,menuRef:V,onVisibleChange:e.onVisibleChange});var T=function(){var t=e.overlay,n;return typeof t=="function"?n=t():n=t,n},Y=function(t){var n=e.onOverlayClick,f=T().props;x(!1),n&&n(t),f.onClick&&f.onClick(t)},_=function(t){var n=e.onVisibleChange;x(t),typeof n=="function"&&n(t)},k=function(){var t,n=T(),f=$(V,n.ref),N=(t={prefixCls:X},w(t,"data-dropdown-inject",!0),w(t,"onClick",Y),w(t,"ref",ee(n)?f:void 0),t);return typeof n.type=="string"&&(delete N.prefixCls,delete N["data-dropdown-inject"]),r.exports.createElement(r.exports.Fragment,null,d&&r.exports.createElement("div",{className:"".concat(i,"-arrow")}),r.exports.cloneElement(n,N))},z=function(){var t=e.overlay;return typeof t=="function"?k:k()},G=function(){var t=e.minOverlayWidthMatchTrigger,n=e.alignPoint;return"minOverlayWidthMatchTrigger"in e?t:!n},J=function(){var t=e.openClassName;return t!==void 0?t:"".concat(i,"-open")},Q=function(){var t=e.children,n=t.props?t.props:{},f=j(n.className,J());return O&&t?r.exports.cloneElement(t,{className:f}):t},A=W;return!A&&M.indexOf("contextMenu")!==-1&&(A=["click"]),r.exports.createElement(te,S(S({builtinPlacements:s},H),{},{prefixCls:i,ref:E,popupClassName:j(K,w({},"".concat(i,"-show-arrow"),d)),popupStyle:F,action:M,showAction:L,hideAction:A||[],popupPlacement:o,popupAlign:y,popupTransitionName:p,popupAnimation:h,popupVisible:O,stretch:G()?"minWidth":"",popup:z(),onPopupVisibleChange:_,getPopupContainer:g}),Q())}var ue=r.exports.forwardRef(le);export{ue as D};
